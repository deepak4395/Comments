# @comments/moderation\n\nThis package provides a small Hugging Face Inference API adapter for moderation and simple generation. It's designed to be used by the Comments app to moderate user-submitted content before publishing.\n\n## Setup\n\n1. Create a Hugging Face account and generate an access token: https://huggingface.co/settings/tokens\n2. Add the token to your environment or repository secrets as `HF_API_TOKEN`.\n3. From the repo root run:\n\n   npm install --prefix packages/moderation\n\n4. Run the example server for manual testing:\n\n   HF_API_TOKEN=hf_xxx npm run start:example --prefix packages/moderation\n\n## Usage\n\nImport the adapter in your server code and call `moderateText` before saving user content:\n\n```ts\nimport { moderateText } from '@comments/moderation';\nconst result = await moderateText('user submitted text');\nif (result.safe === true) { /* publish */ } else if (result.safe === false) { /* flag or block */ } else { /* pending/fallback */ }\n```\n\n## Default models and tuning\n\n- Moderation model (default): `unitary/toxic-bert` — change by passing modelName to `moderateText`.\n- Generation model (default): `gpt2` — used only for simple suggestions; for higher quality choose a larger HF model.\n- Unsafe threshold: 0.75 (adjust in code in hfAdapter.ts)\n\n## Notes\n\n- Do not commit or expose your HF_API_TOKEN in source code. Use repo secrets or environment variables.\n- HF free-tier rate limits apply — consider caching and local fallbacks for production.